<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.niyongsheng.persistence.dao.UserDao">

    <insert id="add" parameterType="com.niyongsheng.persistence.domain.User">
        INSERT INTO user (account, truename, icon, grade, score, gender, phone, password, token, imToken, nickname, introduction, email, address, fellowship, profession, qqOpenid, wcOpenid}, status, gmtModify, gmtCreate)
        VALUE
        (#{account}, #{truename}, #{icon}, #{grade}, #{score}, #{gender}, #{phone}, #{password}, #{token}, #{imToken}, #{nickname}, #{introduction}, #{email}, #{address}, #{fellowship}, #{profession}, #{qqOpenid}, #{wcOpenid}, #{status}, #{gmtModify}, #{gmtCreate})
    </insert>

    <delete id="delete">
        delete dcd_user
        where id = #{id}
    </delete>

    <insert id="update" parameterType="com.niyongsheng.persistence.domain.User">
        UPDATE dcd_user
        SET `account` = #{account},
        WHERE id = #{id}

        INSERT INTO user (account, truename, icon, grade, score, gender, phone, password, token, imToken, nickname, introduction, email, address, fellowship, profession, qqOpenid, wcOpenid}, status, gmtModify, gmtCreate)
        VALUE
        , #{truename}, #{icon}, #{grade}, #{score}, #{gender}, #{phone}, #{password}, #{token}, #{imToken}, #{nickname}, #{introduction}, #{email}, #{address}, #{fellowship}, #{profession}, #{qqOpenid}, #{wcOpenid}, #{status}, #{gmtModify}, #{gmtCreate})
    </insert>

    <select id="find" parameterType="java.lang.Integer" resultType="com.niyongsheng.persistence.domain.User">
        SELECT *
        FROM dcd_user
        WHERE id = #{id}
    </select>

    <select id="findAll" resultType="com.niyongsheng.persistence.domain.User">
        SELECT *
        FROM
        dcd_user
    </select>

    <select id="login" resultType="com.niyongsheng.persistence.domain.User">

    </select>

    <select id="findByFuzzySearch" resultType="com.niyongsheng.persistence.domain.User">
        SELECT * FROM dcd_user
        WHERE 1 = 1
        <if test="nickname != null and nickname != ''">
            AND (nickname LIKE CONCAT('%',#{nickname},'%'))
        </if>
        <if test="account != null and account != ''">
            AND (account LIKE CONCAT('%',#{account},'%'))
        </if>
        <if test="phone != null and phone != ''">
            AND (phone LIKE CONCAT('%',#{phone},'%'))
        </if>
    </select>

</mapper>